# 🧾TIL
## 날짜: 2025-02-06

## 새로 배운 내용

### 학습 키워드 한 줄 정리
|  | 정의 |
| --- | --- |
| 동시성 | 하나의 CPU에서 여러 작업이 동시에 실행되는 것처럼 보이게 하는 것 (실제로는 번갈아가며 진행) |
| 병렬성 | CPU 다중 코어, 다중 프로세서를 사용해 실제로 물리적으로 동시에 처리하는 방식 |
| 스케줄러 | CPU 자원을 각 작업들에 효율적으로 할당하고 실행 순서를 관리하는 운영체제의 핵심 구성 요소 |
| 라운드로빈 스케줄링 | 각각의 프로세스/스레드가 작은 단위의 동등한 CPU 할당 시간을 가지고 번갈아 작업을 수행하는 스케줄링 방식 |
| 선점형 스케줄링 | cpu가 이미 처리하고 있는 프로세스/스레드의 작업이 있어도, 특정 조건에 따라 멈추고 먼저 처리할 수 있도록 스케줄링 하는 방식 (새치기) |
| 비선점형 스케줄링 | cpu가 이미 처리하고 있는 프로세스/스레드의 작업이 있으면 기다렸다가 순차대로 할당하는 스케줄링 방식 |
| 콘보이 현상 | 비선점형 스케줄링 시, 처리 시간이 긴 프로세스가 앞에 있어 다른 짧은 프로세스들이 뒤에서 기다리며 대기 시간이 길어지는 현상 |
| 컨텍스트 스위칭 | 현재 cpu가 수행하고 있는 작업에서 다른 프로세스/스레드의 작업으로 전환하는 것  |
| 스레드 풀 | 사전에 스레드를 만들어 놓고, 스레드에 작업을 할당해 재활용하는 관리 방식 |
| 암달의 법칙 | 병렬화가 가능한 프로그램에서 병렬처리로 얻을 수 있는 최대 속도 향상을 예측하는 법칙 |
| c10k 문제 | current 10k users : 사용자 만 명 이상의 트래픽을 처리하는 서버를 구현하는 문제 |

### 👤 동시성
- 실제로 동시에 진행하는 것은 아니나, 번갈아가며 여러 작업을 처리하는 것
- 효율적인 시스템 자원 활용 : CPU가 놀고 있지 않도록 효율적으로 시스템 자원을 관리함

#### 동작 방식

작업을 작은 단위로 나누어서 실행 시간을 할당하고 스케줄러가 이를 관리하며, 작업 간 전환(컨텍스트 스위칭)을 수행한다.

그렇지만 컨텍스트 스위칭은  맥락을 저장하고, 찾아가는 작업에서 오버헤드가 있는 작업이다. 매번 바꾸는 것이 좋지 않다는 뜻이다.

### 컨텍스트 스위칭

현재 cpu가 수행하고 있는 프로세스의 작업에서 다른 프로세스/스레드의  작업으로 전환하는 것

- 프로세스

프로세스의 작업 상태를 저장하는 곳은 **Process Control Block (PCB)**이다.

프로세스 P0가 작업을 시작 하다, 다른 작업을 요청하기 위해 OS에 “Interrupt” 혹은 “System call”을 호출하면,

OS에서 현재 작업 상태를 PCB0에 저장한다.

요청한 다른 작업은 프로세스 P1에서 이루어질 것이기 때문에,

P1의 PCB를 리로드해 상태를 가져온다.

PCB는 프로세스와 관련된 정보를 저장한다. (pid, 다음 실행할 명령어의 주소(program counter), 프로세스가 접근하는 메모리 주소 및 범위 등등…)

이렇게 프로세스 별로 작업 상태를 저장하고, 불러오고 하다보면 오버헤드가 발생하게 된다.

또한 cpu 캐시에 있는 데이터가 프로세스/스레드가 전환되면 초기화(flush)되어야 하므로 이 또한 오버헤드가 된다.

- 스레드

스레드의 경우에는 Thread Control Block (TCB) 이고, 마찬가지로 thread의 정보와 Program Counter, Register 그리고 PCB를 가리키는 포인터가 저장되어 있다.

pcb보다는 조금 더 작은 자료구조이다. 

### 스레드 풀

- **`thread pool`**: 미리 스레드를 여러 개 만들어 놓고, 재활용 하는 것 (스레드 관리)
    
    
    스레드를 매번 새롭게 만들고 없애는 것은 무거운 작업이다. 새로운 작업이 오면 만들어 놓은 스레드  중, 놀고 있는 스레드를 할당한다.
    
    장점 : **스레드를 생성하고 소멸하는 오버헤드를 줄인다.**

    단점 : 스레드의 갯수가 많아질수록, 각 스레드는 독립적인 스택 메모리를 가지므로 메모리의 소비가 커진다.
    또한 프로세스 내의 스레드들은 자원을 공유하므로, 동기화 비용이 증가한다. 동기화 처리에 실패할 경우 데드락에 빠질 수 있다.
    
- 멀티스레드 환경에서의 동시성 구현
    
    앞서 thread pool을 통해 스레드를 할당 받고, 멀티스레드 환경에서 여러 작업을 처리한다.
    
    동시에 처리하는 것처럼 보이지만, 사실 cpu가 스레드 사이에 컨텍스트 스위칭하며 처리하는 것이다.
    

### 스케줄러

:  운영체제의 핵심 구성 요소로, CPU와 같은 시스템 자원을 적절히 분배하기 위해  프로세스나 스레드의 실행 순서를 관리하는 역할. 동시성 구현 시 스케줄러의 관리가 더 중요해진다.

### 종류

- 장기 스케줄러: 시스템에 얼마나 많은 작업을 실행할지 결정 → 대기 큐에서 작업들을 적절히 선택해 레디 큐로 어떤 프로세스들을 가져올지 선택
- 중기 스케줄러: 메모리에 로드된 작업 중 어떤 작업을 중단할지 결정(스왑)
- 단기 스케줄러: 다음 작업 선택

### 특징

1. 작업 대기열 관리:  작업들을 대기열(큐)에 배치
2. 우선순위 설정
3. 자원 분배: cpu 자원을 나누어 할당
4. 작업 전환: 컨텍스트 스위칭
5. 완료 및 자원 해제

### RR 스케줄링 (라운드 로빈 스케줄링)

동일한 CPU 할당 단위 시간을 두고 번갈아가며 작업을 처리한다.

이때 할당한 단위 시간을 quantumn이라고 한다.

### 선점형 스케줄링

- CPU가 이미 처리하고 있는 작업이 있어도 멈추고(새치기), 다른 작업을 수행할 수 있게 하는 스케줄링 방식
- **`Shortest Remaining Time First`  (SRTF)**

### 비선점형 스케줄링

- CPU가 이미 작업하고 있는 처리하고 다른 작업을 수행할 수 있도록 하는 스케줄링 방식
- ex ) **Fist Come, First Served** (FCFS) 알고리즘이 해당됨
- **콘보이 효과** : 오래 걸리는 작업을 먼저 처리하면서 짧게 수행하는 작업이 그만큼 오래 기다리게 되어 비효율적으로 처리하는 현상
    
---

### 👥 병렬성

- CPU 멀티 코어, 다중 프로세서 등으로 물리적으로 동시에 처리하는 것
- 실시간 처리: 지연 없이  처리되도록 만들어 사용자 경험 극대화
- 대규모 데이터 처리 속도 극대화

### 동시성과의 차이

- **`동시성`** :  하나의 CPU가 여러 작업을 번갈아가며 처리해 동시에 진행하는 것처럼 보이게 하는 것. CPU 스케줄링이 중요하다. I/O 작업 중심 프로그램
- **`병렬성`** : 여러 CPU 코어, 다중 프로세서 등으로 실제로 동시에 처리하는 것, 계산 작업 중심 프로그램

### 프로세스 스케줄링과 스레드 스케줄링의 차이

- **프로세스 스케줄링** : 프로세스 간에 cpu 시간을 분배한다. 독립적인 환경이기 때문에 cpu의 캐시를 매번 초기화 해주어야 하고, 프로세스의 정보를 저장하고 복원하는 등의 오버헤드가 발생한다.

- **스레드 스케줄링** : 스레드 간에 cpu 시간을 분배한다. 메모리 자원을 공유하므로, 컨텍스트 스위칭 과정에서 오버헤드가 비교적 적은 편이다. 그러나 스레드 간에 cpu 자원을 두고 경쟁하는 상황이나, 공유 자원에 대한 동기화 문제가 발생할 수 있다.


### 오늘의 회고
오늘 배운 내용은 동시성, 병렬성에 관련한 내용으로 동시성과 병렬성의 차이점과 동시성 구현에서 중요한 스레드 풀, 스케줄링 방식에 대해서 살펴보았습니다.

애매하게 알았던 개념들을 다시 살펴보며 기억을 되짚어보고 더욱 심화적인 키워드를 정리하는 시간이 된 것 같아 뿌듯합니다😀

cs 지식을 학습하는 건 어렵지만 잘 정리해두면 기억에 오래 남는 것 같다는 생각이 들었습니다.

요즘은 어디에서도 쓰일 탄탄한 CS 지식을 쌓을 필요성을 더욱 느끼고 있습니다 ..

내일은 이번 주차에 배운 CS 지식에 조금 더 무게를 두고 딥다이브할 계획입니다🚢
